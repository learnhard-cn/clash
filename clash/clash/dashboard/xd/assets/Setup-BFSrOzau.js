import{u as z,a as A,b as P,o as q,e as u,c as H,i as r,d as h,B as U,I as M,F as N,t as C,s as b,f as _,g as T,h as S,j as X,k as G,l as J}from"./index-B3l_s7jA.js";import{c as K,v as O,z as v}from"./index-Cax71549.js";let m;const Q=new Uint8Array(16);function W(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(Q)}const l=[];for(let t=0;t<256;++t)l.push((t+256).toString(16).slice(1));function Y(t,n=0){return l[t[n+0]]+l[t[n+1]]+l[t[n+2]]+l[t[n+3]]+"-"+l[t[n+4]]+l[t[n+5]]+"-"+l[t[n+6]]+l[t[n+7]]+"-"+l[t[n+8]]+l[t[n+9]]+"-"+l[t[n+10]]+l[t[n+11]]+l[t[n+12]]+l[t[n+13]]+l[t[n+14]]+l[t[n+15]]}const Z=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),E={randomUUID:Z};function tt(t,n,y){if(E.randomUUID&&!n&&!t)return E.randomUUID();t=t||{};const i=t.random||(t.rng||W)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Y(i)}var et=C('<div class="mx-auto flex max-w-screen-sm flex-col items-center gap-4 py-10"><form class=contents><div class="flex w-full flex-col gap-4"><div class=flex-1><label class=label><span class=label-text></span></label><input name=url type=url class="input input-bordered w-full"placeholder=http://127.0.0.1:9090 list=defaultEndpoints><datalist id=defaultEndpoints><option value=http://127.0.0.1:9090></option></datalist></div><div class=flex-1><label class=label><span class=label-text></span></label><input name=secret type=password class="input input-bordered w-full"placeholder=secret></div></div></form><div class="grid w-full grid-cols-2 gap-4">'),nt=C('<div class="badge badge-info flex w-full cursor-pointer items-center justify-between gap-4 py-4"><span class=truncate>');const st=v.object({url:v.string().min(1),secret:v.string()}),it=()=>{const[t]=z(),n=A(),y=P(),i=s=>{S(s),y("/overview")},x=(s,e)=>G.get(s,{headers:e?{Authorization:`Bearer ${e}`}:{}}).then(({ok:a})=>a).catch(a=>{const{message:o}=a;_.error(o)}),R=async s=>{const e=u().find(a=>a.id===s);e&&await x(e.url,e.secret)&&i(s)},g=async({url:s,secret:e})=>{const a=J(s);if(!await x(a,e))return;const o=tt(),c=u().slice(),d=c.find(f=>f.url===a);if(!d){b([{id:o,url:a,secret:e},...c]),i(o);return}d.secret=e,d.id=o,b(c),i(o)},I=s=>{const{message:e}=s;_.error(e)},{form:$}=K({extend:O({schema:st}),onSubmit:g,onError:I}),L=s=>{T()===s&&S(""),b(u().filter(e=>e.id!==s))};return q(()=>{let s=n.search;if(s.length===0){const a=n.hash.match(/\?.*$/);a.length>0&&a[0].length>0&&(s=a[0].replace("?","",1))}const e=new URLSearchParams(s);e.has("hostname")?g({url:`${e.get("http")?"http:":e.get("https")?"https:":window.location.protocol}//${e.get("hostname")}${e.get("port")?`:${e.get("port")}`:""}`,secret:e.get("secret")??""}):u().length===0&&g({url:"http://127.0.0.1:9090",secret:""})}),(()=>{var s=et(),e=s.firstChild,a=e.firstChild,o=a.firstChild,c=o.firstChild,d=c.firstChild,f=o.nextSibling,k=f.firstChild,D=k.firstChild,j=e.nextSibling;return H($,e,()=>$),r(d,()=>t("endpointURL")),r(D,()=>t("secret")),r(a,h(U,{type:"submit",class:"btn-primary uppercase",get children(){return t("add")}}),null),r(j,h(N,{get each(){return u()},children:({id:w,url:V})=>(()=>{var p=nt(),B=p.firstChild;return p.$$click=()=>R(w),r(B,V),r(p,h(U,{class:"btn-circle btn-ghost btn-xs text-white",onClick:F=>{F.stopPropagation(),L(w)},get children(){return h(M,{})}}),null),p})()})),s})()};X(["click"]);export{it as default};
